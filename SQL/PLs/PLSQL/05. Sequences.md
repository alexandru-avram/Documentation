# Sequences

A sequence is a database object that automatically generates unique numeric values in a defined order.Commonly used to:
* Generate primary keys or surrogate keys
* Create transaction IDs, order numbers, etc.
* Ensure unique values across rows, even across sessions

## Creating a Sequence

```
CREATE SEQUENCE sequence_name
  START WITH 1
  INCREMENT BY 1
  [MAXVALUE n | NOMAXVALUE]
  [MINVALUE n | NOMINVALUE]
  [CYCLE | NOCYCLE]
  [CACHE n | NOCACHE];
```

Example:

```
CREATE SEQUENCE emp_seq
  START WITH 1000
  INCREMENT BY 1
  NOCACHE
  NOCYCLE;
```

#### Dropping and Recreating a Sequnce
You cannot modify some sequence attributes (like START WITH), so you may need to recreate it.

```
DROP SEQUENCE emp_seq;

CREATE SEQUENCE emp_seq
  START WITH 1
  INCREMENT BY 1
  CACHE 20;
```

## Properties & Actions

Property | Meaning
|--|--|
`START WITH` | The first value returned by NEXTVAL
`INCREMENT BY` | Step value (+ or -)
`MAXVALUE` | Highest number allowed
`MINVALUE` | Smallest number allowed
`CYCLE` | Starts over at MINVALUE or START WITH when MAXVALUE is reached
`CACHE` | Preallocates values in memory for performance
`NOCACHE` | Avoids caching (slower but safer if crashes)

Action | Syntax Example
|--|--|
Create sequence | `CREATE SEQUENCE emp_seq START WITH 1;`
Get next value | `emp_seq.NEXTVAL`
Get current value | `emp_seq.CURRVAL (after NEXTVAL)`
Drop sequence | `DROP SEQUENCE emp_seq;`
Use in INSERT | `INSERT INTO t VALUES (seq.NEXTVAL, ...)`

## Using a Sequence

```
sequence_name.NEXTVAL   -- Get the next number (increments)
sequence_name.CURRVAL   -- Get the current number (after NEXTVAL is called)
```

#### Example with INSERT

```
INSERT INTO employees (id, name)
VALUES (emp_seq.NEXTVAL, 'Alex');
```

#### Example with a variable

You can also store the result into a variable in PL/SQL:

```
DECLARE
  v_new_id NUMBER;
BEGIN
  SELECT emp_seq.NEXTVAL INTO v_new_id FROM dual;
  DBMS_OUTPUT.PUT_LINE('Generated ID: ' || v_new_id);
END;
```

## Simulating AUTO_INCREMENT
Oracle doesnâ€™t have `AUTO_INCREMENT` like MySQL. You combine:
* A sequence
* A trigger to auto-fill the ID.

```
CREATE OR REPLACE TRIGGER trg_emp_id
BEFORE INSERT ON employees
FOR EACH ROW
BEGIN
  :NEW.id := emp_seq.NEXTVAL;
END;
```

## Querying Sequence Metadata
You can query metadata from `USER_SEQUENCES` or `ALL_SEQUENCES`:

```
SELECT sequence_name, last_number, cache_size
FROM user_sequences
WHERE sequence_name = 'EMP_SEQ';
```
