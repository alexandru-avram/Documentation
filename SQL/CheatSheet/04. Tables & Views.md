# TABLES & VIEWS


- [TABLES](#tables)
  - [CREATE TABLE](#create-table)
  - [INSERT INTO](#insert-into)
  - [UPDATE](#update)
  - [ALTER TABLE](#alter)
  - [DELETE](#delete)
  - [DROP TABLE](#drop)
- [VIEWS](#views)
  - [CREATE VIEW](#create-view)
  - [SELECT FROM VIEW](#select-view)
  - [ALTER VIEW](#alter-view)
  - [DROP VIEW](#drop-view)
  - [MATERIALIZED VIEW](#materialized-view)
- [DATABASE CONSTRAINTS AND KEYS](#database-constraints-and-keys)
  - [PRIMARY KEY](#primary-key)
  - [FOREIGN KEY](#foreign-key)
  - [UNIQUE](#unique)
  - [CHECK](#check)
  - [CONSTRAINT](#constraint)

<BR>

 
## TABLES

### CREATE TABLE
Creates a new table with specified columns and data types.

```
CREATE TABLE table_name (
  column1 datatype,
  column2 datatype,
  ...
);
```

#### DUPLICATE TABLE
We can duplicate a table, and even decide not to populate it with data

```
CREATE TABLE table_name2 AS (SELECT * FROM table_name) WITH NO DATA;
```

### INSERT INTO
Adds new records to a table.

```
INSERT INTO table_name (column1, column2, ...)
VALUES (value1, value2, ...);
```

### UPDATE
Modifies existing records in a table.

```
UPDATE table_name
SET column1 = value1, column2 = value2
WHERE condition;
```

### ALTER TABLE
Modifies an existing table (e.g., add, modify, rename or drop columns).

#### Add Column
```
ALTER TABLE table_name
ADD column_name datatype;
```

#### Modify Column
```
ALTER TABLE table_name
MODIFY column_name new_datatype;
```

#### Rename Column
```
ALTER TABLE table_name
RENAME COLUMN old_column_name TO new_column_name;
```

#### Drop Column
```
ALTER TABLE table_name
DROP COLUMN column_name;
```

### DELETE
Removes records from a table.

```
DELETE FROM table_name
WHERE condition;
```

#### DELETE DUPLICATES
Remove duplicates.

```
DELETE FROM table_name a USING table_name b
WHERE 1=1
AND a.column1 < b.column1
AND a.column2 = b.column2
```

### DROP TABLE
Removes an entire table from the database.

```
DROP TABLE table_name;
```

<BR>

## VIEWS
A SQL view is a virtual table derived from the result of a SELECT query. Unlike physical tables, views do not store the data themselves but provide a way to represent the result of a query as a named, reusable object. Views can be used to simplify complex queries, encapsulate business logic, and provide a security layer by restricting access to specific columns or rows.

### CREATE VIEW
Creates a virtual table based on the result of a SELECT query.

```
CREATE VIEW view_name AS
SELECT column1, column2, ...
FROM table_name
WHERE condition;
```

### SELECT FROM VIEW
Retrieves data from a view using a SELECT statement.

```
SELECT column1, column2, ...
FROM view_name;
```

### ALTER VIEW
Modifies the definition of an existing view.

```
ALTER VIEW view_name AS
SELECT new_column1, new_column2, ...
FROM new_table_name
WHERE new_condition;
```

### DROP VIEW
Deletes an existing view.

```
DROP VIEW view_name;
```

### MATERIALIZED VIEW

Materialized views are database objects that store the result of a query physically, unlike regular views that are virtual (they generate data on the fly when queried). They are typically used for performance optimization in scenarios with large datasets, expensive computations, or complex joins.


```
CREATE MATERIALIZED VIEW view_name AS
SELECT column1, column2, ...
FROM table_name
WHERE condition;
```

#### REFRESING A MATERIALIZED VIEW

Manual refresh:
```
REFRESH MATERIALIZED VIEW view_name;
```

Some databases support automatic refresh intervals:

```
CREATE MATERIALIZED VIEW view_name
BUILD IMMEDIATE
REFRESH FAST
START WITH SYSDATE
NEXT SYSDATE + 1/1440;  -- Every minute
AS
SELECT * FROM table_name;
```


<BR>

## DATABASE CONSTRAINTS AND KEYS

### PRIMARY KEY
A primary key is a column or a set of columns that uniquely identifies each row in a table. It enforces entity integrity, meaning each row in a table is uniquely identified and cannot contain null values.

```
CREATE TABLE employees (
    employee_id INT PRIMARY KEY,
    first_name VARCHAR(50),
    last_name VARCHAR(50)
);
```
### FOREIGN KEY
A foreign key is a column or a set of columns in a table that establishes a link between data in two tables. It enforces referential integrity, ensuring that the values in the foreign key column(s) match the values in the primary key of another table.

```
CREATE TABLE orders (
    order_id INT PRIMARY KEY,
    customer_id INT,
    order_date DATE,
    FOREIGN KEY (customer_id) REFERENCES customers(customer_id)
);
```

### UNIQUE
A unique constraint ensures that the values in a column or a set of columns are unique across all rows in a table. Unlike primary keys, unique constraints allow null values unless specified otherwise.

```
CREATE TABLE students (
    student_id INT PRIMARY KEY,
    student_name VARCHAR(50) UNIQUE,
    date_of_birth DATE
);
```

### CHECK
A check constraint defines a condition that each row in a table must satisfy. It ensures that the values in a column meet specific criteria, preventing invalid data from being inserted into the table.

```
CREATE TABLE products (
    product_id INT PRIMARY KEY,
    product_name VARCHAR(100),
    price DECIMAL(10, 2),
    quantity INT,
    CHECK (price > 0 AND quantity >= 0)
);
```

### CONSTRAINT
A constraint is a rule defined on a column or a set of columns in a table that restricts the values allowed in those columns. It can be used to enforce data integrity and maintain consistency in the database.

```
CREATE TABLE employees (
    employee_id INT PRIMARY KEY,
    first_name VARCHAR(50),
    last_name VARCHAR(50),
    CONSTRAINT chk_employee_age CHECK (age >= 18)
);
```
