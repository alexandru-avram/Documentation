# FUNCTIONS

# INDEX
- [AGGREGATE FUNCTIONS](#aggregate-functions)
  - [COUNT](#count)
  - [SUM](#sum)
  - [AVG](#avg)
  - [MIN](#min)
  - [MAX](#max)
- [FUNCTIONS](#functions)
  - [LENGTH](#length)
  - [LEN (T-SQL)](#len-tsql)
  - [COALESCE](#coalesce)
  - [CAST](#cast)
  - [LEFT](#left)
  - [RIGHT](#right)
  - [SUBSTR](#substr)
  - [CHARINDEX (T-SQL)](#CHARINDEX-T-SQL)
  - [TRIM](#trim)
  - [CONCAT](#concat)
  - [REPLACE](#replace)
  - [REVERSE (T-SQL)](#reverse-t-sql)
  - [LOWER](#lower)
  - [UPPER](#upper)
  - [ROUND](#round)
  - [FLOOR](#floor)
  - [CEILING](#ceiling)
  - [CEIL (Oracle)](#ceil-oracle)
  - [TO_CHAR](#to_char)
  - [TO_DATE](#to_date)
  - [FORMAT (T-SQL)](#format-t-sql)
  - [ISNUMERIC (T-SQL)](#isnumeric-t-sql)
- [WINDOW FUNCTIONS](#ranking-functions)
  - [ROW_NUMBER](#row_number)
  - [RANK](#rank)
  - [DENSE_RANK](#dense_rank)
  - [NTILE](#ntile)
  - [PARTITION BY](#partition-by)
  - [LAG](#lag)
  - [LEAD](#lead)
  - [FIRST_VALUE](#first_value)
  - [LAST_VALUE](#last_value)
 
<br>

## AGGREGATE FUNCTIONS

### COUNT
Counts the number of rows.

```
SELECT COUNT(column)
FROM table_name;
```

### SUM
Calculates the sum of values in a column.

```
SELECT SUM(column)
FROM table_name;
```

### AVG
Calculates the average of values in a column.

```
SELECT AVG(column)
FROM table_name;
```

### MIN
Finds the minimum value in a column.

```
SELECT MIN(column)
FROM table_name;
```

### MAX
Finds the maximum value in a column.

```
SELECT MAX(column)
FROM table_name;
```

## FUNCTIONS

### LENGTH
Returns the number of characters in a string.

```
SELECT LENGTH(column_name) AS length
FROM table_name;
```

### LEN (T-SQL)
`LENGTH` function specific only to Oracle.

```
SELECT LEN(column_name) AS length
FROM table_name;
```

### COALESCE
Returns the first non-null expression in the list.

```
SELECT COALESCE(column1, column2, 'DefaultValue') AS result
FROM table_name;
```

### CAST
Converts a value from one data type to another.

```
SELECT CAST(column_name AS new_data_type) AS result
FROM table_name;
```

### LEFT
Returns a specified number of characters from the beginning of a string.

```
SELECT LEFT(column_name, 3) AS left_part
FROM table_name;
```

### RIGHT
Returns a specified number of characters from the end of a string.

```
SELECT RIGHT(column_name, 3) AS right_part
FROM table_name;
```

### SUBSTR
Extracts a substring from a string.

```
SELECT SUBSTR(column_name, start_position, length) AS substring
FROM table_name;
```

### CHARINDEX (T-SQL)
Returns the starting position of a substring in a string, specific to T-SQL.

```
SELECT CHARINDEX('substring', column_name) AS position
FROM table_name;
```

### TRIM
Removes leading and trailing spaces from a string.

```
SELECT TRIM(column_name) AS trimmed_value
FROM table_name;
```

### CONCAT
Concatenates two or more strings into a single string.

```
CONCAT(string1, string2, ...)
```

#### CONCAT_WS
Stands for *concatenate with separator*. It concatenates two or more strings into a single string, but it allows you to specify a separator that is placed between the concatenated strings.

```
CONCAT_WS(separator, string1, string2, ...)
```

### REPLACE
Replaces occurrences of a specified string with another string.

```
SELECT REPLACE(column_name, 'old_value', 'new_value') AS result
FROM table_name;
```

### REVERSE (T-SQL)
Reverses the characters in a string.

```
SELECT REVERSE(column_name) AS reversed_value
FROM table_name;
```


### LOWER
Converts a string to lowercase.

```
SELECT LOWER(column_name) AS lowercase_value
FROM table_name;
```

### UPPER
Converts a string to uppercase.

```
SELECT UPPER(column_name) AS uppercase_value
FROM table_name;
```

### ROUND
Rounds a numeric value to the specified number of decimal places.

```
SELECT ROUND(column_name, 2) AS rounded_value
FROM table_name;
```

### FLOOR
Returns the largest integer less than or equal to a numeric value.

```
SELECT FLOOR(column_name) AS floored_value
FROM table_name;
```

### CEILING
Returns the smallest integer greater than or equal to a numeric value.

```
SELECT CEILING(column_name) AS ceiling_value
FROM table_name;
```

### CEIL (Oracle)
Returns the smallest integer greater than or equal to a numeric value, specific only to Oracle.

```
SELECT CEILING(column_name) AS ceiling_value
FROM table_name;
```

### TO_CHAR
Converts a date/timestamp or number to text using a format model.

```
-- Oracle / PostgreSQL
SELECT TO_CHAR(value, 'format_model') AS result
FROM table_name;
```

Examples:
```
----- DATES

-- Oracle
SELECT TO_CHAR(SYSDATE, 'YYYY-MM-DD"T"HH24:MI:SS') AS iso_dt FROM dual;

-- PostgreSQL
SELECT TO_CHAR(NOW(), 'YYYY-MM-DD HH24:MI:SS') AS ts_str;

----- NUMBERS
-- Oracle
SELECT TO_CHAR(12345.6, 'FM9G999D00') AS n_fmt FROM dual;   -- 12,345.60

-- PostgreSQL
SELECT TO_CHAR(12345.6, 'FM9G999D00') AS n_fmt;             -- 12,345.60
```

### TO_DATE
Parses a text value into a DATE using a format model.

```
-- Oracle / PostgreSQL
SELECT TO_DATE(text_value, 'format_model') AS the_date
FROM table_name;
```

Example:


```
-- Oracle (DATE includes time to seconds; defaults to current session time if not provided)
SELECT TO_DATE('2025-08-29','YYYY-MM-DD') AS d FROM dual;

-- PostgreSQL (returns date, no time component)
SELECT TO_DATE('29-08-2025','DD-MM-YYYY') AS d;
```


### FORMAT (T-SQL)
Formats a value with the specified format.

```
SELECT FORMAT(column_name, 'yyyy-MM-dd') AS formatted_date
FROM table_name;
```


### ISNUMERIC (T-SQL)
Checks if a value is numeric.

```
SELECT column_name
FROM table_name
WHERE ISNUMERIC(column_name) = 1;
```

## WINDOW FUNCTIONS

### ROW_NUMBER
Assigns a unique integer to each row within a partition of the result set, starting from 1.

```
SELECT column1, column2, ..., ROW_NUMBER() OVER (ORDER BY column1) AS row_num
FROM table_name;
```

### RANK
Assigns a unique rank to each distinct row, with ties receiving the same rank, leaving gaps between ranks.

```
SELECT column1, column2, ..., RANK() OVER (ORDER BY column1) AS ranking
FROM table_name;
```

### DENSE_RANK
Assigns a unique rank to each distinct row, with ties receiving the same rank, without leaving gaps between ranks.

```
SELECT column1, column2, ..., DENSE_RANK() OVER (ORDER BY column1) AS dense_rank
FROM table_name;
```

### NTILE
Divides the result set into a specified number of roughly equal parts, assigning a bucket number to each row.

```
SELECT column1, column2, ..., NTILE(4) OVER (ORDER BY column1) AS quartile
FROM table_name;
```

### PARTITION BY
Divides the result set into partitions to perform window functions independently on each partition.

```
SELECT column1, column2, ..., ROW_NUMBER() OVER (PARTITION BY column3 ORDER BY column1) AS row_num
FROM table_name;
```

### LAG
Accesses data from a previous row within the result set based on the specified column order.

```
SELECT column1, column2, ..., LAG(column1, 1) OVER (ORDER BY column1) AS prev_value
FROM table_name;
```

### LEAD
Accesses data from a subsequent row within the result set based on the specified column order.

```
SELECT column1, column2, ..., LEAD(column1, 1) OVER (ORDER BY column1) AS next_value
FROM table_name;
```

### FIRST_VALUE
Returns the value of the specified expression for the first row in the window frame.

```
SELECT column1, column2, ..., FIRST_VALUE(column1) OVER (ORDER BY column1) AS first_value
FROM table_name;
```

### LAST_VALUE
Returns the value of the specified expression for the last row in the window frame.

```
SELECT column1, column2, ..., LAST_VALUE(column1) OVER (ORDER BY column1) AS last_value
FROM table_name;
```
